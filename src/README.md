# ローカル開発サーバー セットアップガイド

## 概要
「いまなにしてる？」タイムラインアプリのローカル開発環境のセットアップ方法です。

## 前提条件
- Node.js 22以上がインストールされていること
- npm が利用可能であること

## セットアップ手順

### 1. 依存関係のインストール
```bash
cd src
npm install
```

### 2. サーバーの起動
```bash
npm start
```

または

```bash
node server.js
```

### 3. アプリケーションへのアクセス
ブラウザで以下のURLにアクセスしてください：
```
http://localhost:3000
```

## サーバーの再起動方法

### 通常の再起動
1. ターミナルで `Ctrl + C` を押してサーバーを停止
2. 再度 `npm start` または `node server.js` を実行

### 強制終了が必要な場合
```bash
# プロセスを確認
lsof -i :3000

# プロセスを強制終了（PIDを指定）
kill -9 <PID>
```

## データベースについて

### データベースファイル
- ファイル名: `timeline.db`
- 場所: `src/` ディレクトリ内
- 形式: SQLite3 (sqlite3ライブラリ使用)

### データベースのリセット
データベースをリセットしたい場合は、以下のファイルを削除してください：
```bash
rm src/timeline.db
```
次回サーバー起動時に自動的に新しいデータベースが作成されます。

## API エンドポイント

### 投稿一覧取得
```
GET /api/posts
```
最新1000件の投稿を取得します。

### 新規投稿作成
```
POST /api/posts
Content-Type: application/json

{
  "author": "ユーザー名",
  "content": "投稿内容（50文字以内）",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### ヘルスチェック
```
GET /api/health
```
サーバーの状態を確認できます。

## トラブルシューティング

### ポート3000が使用中の場合
環境変数でポートを変更できます：
```bash
PORT=3001 npm start
```

### データベースエラーが発生した場合
1. `timeline.db` ファイルを削除
2. サーバーを再起動

### メモリ不足の場合
Node.jsのメモリ制限を増やしてください：
```bash
node --max-old-space-size=4096 server.js
```

## 開発時の注意事項

- サーバーを停止する際は `Ctrl + C` を使用してください
- データベースファイル（`timeline.db`）はバックアップを取ることを推奨します
- 本番環境では環境変数で設定を管理してください

## ログの確認
サーバーのログはターミナルに表示されます。エラーが発生した場合は、ターミナルの出力を確認してください。

## パフォーマンス
- 投稿は最新1000件まで表示されます
- 3秒おきにタイムラインが自動更新されます
- データベースにはインデックスが設定されており、高速な検索が可能です


##このサーバーの停止方法
Ctrl+C

##このサーバーの再起動方法
- 他のサーバーが動いていたら停止
- 